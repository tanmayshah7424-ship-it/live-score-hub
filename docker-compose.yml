services:
  # Frontend Service
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: scorehub-frontend
    ports:
      - "80:80"
    environment:
      - VITE_SUPABASE_URL=${VITE_SUPABASE_URL:-https://your-project.supabase.co}
      - VITE_SUPABASE_ANON_KEY=${VITE_SUPABASE_ANON_KEY:-your-key}
    depends_on:
      - backend
    networks:
      - scorehub-network
    restart: unless-stopped

  # Backend Service
  backend:
    build:
      context: ./server
      dockerfile: Dockerfile
    container_name: scorehub-backend
    ports:
      - "5000:5000"
    environment:
      - NODE_ENV=production
      - PORT=5000
      - MONGODB_URI=${MONGODB_URI:-mongodb://mongo:27017/scorehub}
      - JWT_SECRET=${JWT_SECRET:-scorehub_jwt_secret_key_2026_production}
      - SPORTSDB_API_KEY=${SPORTSDB_API_KEY:-3}
      - CRICAPI_KEY=${CRICAPI_KEY:-ef7c296a-468c-4968-9dfb-f4c8101d5320}
      - EMAIL_USER=${EMAIL_USER:-your-email@gmail.com}
      - EMAIL_PASS=${EMAIL_PASS:-your-app-password-here}
      - FRONTEND_URL=${FRONTEND_URL:-http://localhost}
      - SUPABASE_URL=${SUPABASE_URL:-https://your-project.supabase.co}
      - SUPABASE_SERVICE_ROLE_KEY=${SUPABASE_SERVICE_ROLE_KEY:-secret-key}
    depends_on:
      - mongo
    networks:
      - scorehub-network
    restart: unless-stopped

  # MongoDB Service
  mongo:
    image: mongo:latest
    container_name: scorehub-mongo
    ports:
      - "27017:27017"
    volumes:
      - mongo_data:/data/db
    networks:
      - scorehub-network
    restart: unless-stopped

networks:
  scorehub-network:
    driver: bridge

volumes:
  mongo_data:
